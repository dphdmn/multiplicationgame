<!DOCTYPE html>
<html>

<head>
    <title>Multiplication Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: #fff;
            overflow: hidden;
        }

        #quiz-window {
            min-width: 600px;
        }

        .container {
            background-color: #222;
            max-width: 650px;
            padding: 20px;
            border-radius: 30px;
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.15);
            text-align: center;
        }

        #resultsWindow {
            margin-left: 100px;
            min-width: 600px;
        }

        #quick {
            margin-top: -100px;
            position: relative;
            top: 200px;
        }

        #quick-start-1 {
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
        }

        #quick-start-2 {
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.2);
        }

        #quick-start-3 {
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.2);
        }

        h1 {
            margin-top: 0;
            color: #fff;
        }

        #question {
            font-size: 90px;
            margin-bottom: 20px;
            color: cyan;
        }

        #input {
            font-size: 56px;
            width: 300px;
            padding: 5px;
            text-align: center;
            background-color: #444;
            color: cyan;
            border: none;
            border-radius: 5px;
        }

        #timer {
            font-family: 'Arial', sans-serif;
            font-size: 18px;
            text-align: center;
            background-color: #444;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
            margin-top: 20px;
        }

        #total-time,
        #question-number,
        #question-time {
            font-weight: bold;
            color: #fff;
            margin-right: 30px;
        }

        #total-time::before,
        #question-time::before {
            content: '⏱️';
            margin-right: 5px;
        }

        #question-number::before {
            content: '❔';
            margin-right: 5px;
        }

        #settings {
            position: relative;
            top: -100px;
            display: block;
            min-width: 670px;
        }

        #settings label,
        #settings button {
            margin: 5px;
            color: #fff;
            background-color: #444;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
        }

        #start-btn {
            font-size: 18px;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }

        #settings select {
            margin: 5px;
            color: #fff;
            background-color: #444;
            border: none;
            border-radius: 5px;
            padding: 5px;
            cursor: pointer;
        }

        #result-container {
            display: none;
            margin-top: 20px;
        }

        #result-container h2 {
            margin-top: 0;
            color: #fff;
        }

        #main_results {
            font-size: 24px;
        }

        #result {
            font-size: 24px;
            color: #fff;
            max-height: 300px;
            /* Adjust the desired maximum height here */
            overflow-y: auto;
        }

        #resultsGraph {
            margin: 20px;
        }

        table.question-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table.question-table thead th {
            background-color: #444;
            color: #fff;
            padding: 4px;
            border: 1px solid cyan;
        }

        table.question-table tbody td {
            padding: 4px;
            border: 1px solid cyan;
        }

        table.question-table tbody tr:nth-child(even) {
            background-color: #222;
        }

        table.question-table {
            font-size: 16px;
            width: 70%;
            border-collapse: collapse;
            margin-top: 20px;
            margin: 0 auto;
        }

        ::-webkit-scrollbar {
            width: 3px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: cyan;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #5bc0de;
        }

        .no-spinners::-webkit-inner-spin-button,
        .no-spinners::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .no-spinners {
            -moz-appearance: textfield;
        }
    </style>
</head>

<body>
    <div class="container" id="settings">
        <h1>Multiplication game</h1>
        <label for="question-count">Number of Questions:</label>
        <select id="question-count">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="25">25</option>
            <option value="30">30</option>
            <option value="35">35</option>
            <option value="40">40</option>
            <option value="45">45</option>
            <option value="50">50</option>
            <option value="55">55</option>
            <option value="60">60</option>
            <option value="65">65</option>
            <option value="70">70</option>
            <option value="75">75</option>
            <option value="80">80</option>
            <option value="85">85</option>
            <option value="90">90</option>
            <option value="95">95</option>
            <option value="100">100</option>
        </select>
        <label for="limit-number">Limit Number:</label>
        <select id="limit-number">
            <option value="10">10</option>
            <option value="50">50</option>
            <option value="100">100</option>
            <option value="1000">1000</option>
            <option value="10000">10000</option>
        </select>
        <button id="start-btn">Start</button>
        <div class="container" id="quick">
            <h1>Quick start</h1>
            <button id="quick-start-1">10 questions with limit 100</button>
            <button id="quick-start-2">25 questions with limit 100</button>
            <button id="quick-start-3">100 questions with limit 100</button><br>
        </div>

    </div>
    <div class="container" id="resultsWindow" style="display: none;">
        <div id="result-container">
            <div id="main_results"></div>
            <div id="result"></div>
            <canvas id="resultsGraph"><canvas>
        </div>
    </div>

    <div class="container" id="quiz-window" style="display: none;">

        <div id="question"></div>
        <input type="number" inputmode="numeric" id="input" class="no-spinners" autofocus>
        <div id="timer">
            Timer: <span id="total-time">0s</span>
            Question: <span id="question-number">0/0</span>
            Question Time: <span id="question-time">0s</span>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://unpkg.com/random-js@2.0.0/dist/random-js.min.js"></script>
    <script>
        const questionCountSelect = document.getElementById('question-count');
        const limitNumberSelect = document.getElementById('limit-number');
        const startButton = document.getElementById('start-btn');
        const quickStartButtons = document.querySelectorAll('button[id^="quick-start-"]');

        // Add event listeners to the quick start buttons
        quickStartButtons.forEach((button, index) => {
            button.addEventListener('click', () => {
                // Update the select elements
                if (index === 0) {
                    questionCountSelect.value = '10';
                    limitNumberSelect.value = '100';
                } else if (index === 1) {
                    questionCountSelect.value = '25';
                    limitNumberSelect.value = '100';
                } else if (index === 2) {
                    questionCountSelect.value = '100';
                    limitNumberSelect.value = '100';
                } else if (index === 3) {
                    questionCountSelect.value = '5';
                    limitNumberSelect.value = '1000';
                } else if (index === 4) {
                    questionCountSelect.value = '10';
                    limitNumberSelect.value = '1000';
                }

                // Trigger the click event on the Start button
                startButton.click();
            });
        });

        var myChart;
        var questions = [];
        var currentIndex = 0;
        var startTime;
        var questionStartTime;
        var log = [];
        var questionCount = 10; // Default number of questions
        var limitNumber = 10; // Default limit number for multiplication
        var totalTime = 0;
        var timerInterval;
        var eng = Random.MersenneTwister19937.autoSeed();
        var myrandom = new Random.Random(eng);

        function generateQuestions() {
            for (var i = 0; i < questionCount; i++) {
                var num1 = myrandom.integer(5, limitNumber);
                var num2 = myrandom.integer(5, limitNumber);
                questions.push({
                    num1: num1,
                    num2: num2,
                    answer: num1 * num2
                });
            }
        }

        function displayQuestion(index) {
            var currentQuestion = questions[index];
            var questionElement = document.getElementById('question');
            questionElement.textContent = currentQuestion.num1 + ' × ' + currentQuestion.num2 + ' = ';
        }

        function checkAnswer() {
            var inputElement = document.getElementById('input');
            var userAnswer = parseInt(inputElement.value);

            var currentQuestion = questions[currentIndex];
            var expectedAnswer = currentQuestion.answer;

            if (userAnswer === expectedAnswer) {
                var endTime = new Date();
                var timeTaken = endTime - questionStartTime;
                log.push({
                    question: currentQuestion,
                    time: timeTaken
                });
                totalTime += timeTaken;

                currentIndex++;
                inputElement.value = '';

                if (currentIndex < questions.length) {
                    displayQuestion(currentIndex);
                    questionStartTime = new Date();
                    updateQuestionNumber();
                } else {
                    finishQuiz();
                }
            }
        }

        function finishQuiz() {
            clearInterval(timerInterval);
            var mainresults = document.getElementById('main_results');
            var resultElement = document.getElementById('result');
            resultElement.innerHTML = '';
            var totalSeconds = totalTime / 1000;
            var modeInfoElements = document.createElement('div');
            modeInfoElements.textContent = log.length + " questions with limit number " + limitNumber
            modeInfoElements.style.margin = '10px';
            mainresults.appendChild(modeInfoElements);
            var totalElement = document.createElement('div');
            totalElement.textContent = 'Total time: ' + totalSeconds + ' seconds (' + (totalSeconds / log.length).toFixed(3) + 's per question)';
            totalElement.style.fontWeight = 'bold';
            totalElement.style.margin = '20px';
            mainresults.appendChild(totalElement);

            // Get the result element
            var resultElement = document.getElementById('result');

            // Create the table element
            var table = document.createElement('table');
            table.classList.add('question-table');

            // Create the table header
            var tableHeader = document.createElement('thead');
            var headerRow = document.createElement('tr');
            var headerNumber = document.createElement('th');
            var headerNum1 = document.createElement('th');
            var headerNum2 = document.createElement('th');
            var headerAnswer = document.createElement('th');
            var headerTime = document.createElement('th');
            headerNumber.textContent = '#';
            headerNum1.textContent = 'Num1';
            headerNum2.textContent = 'Num2';
            headerAnswer.textContent = 'Answer';
            headerTime.textContent = 'Time (s)';
            headerRow.appendChild(headerNumber);
            headerRow.appendChild(headerNum1);
            headerRow.appendChild(headerNum2);
            headerRow.appendChild(headerAnswer);
            headerRow.appendChild(headerTime);
            tableHeader.appendChild(headerRow);

            // Create the table body
            var tableBody = document.createElement('tbody');

            // Iterate through the log and populate the table rows
            for (var i = 0; i < log.length; i++) {
                var questionNumber = i + 1;
                var questionTime = log[i].time / 1000;
                var question = log[i].question;

                var row = document.createElement('tr');
                var numberCell = document.createElement('td');
                var num1Cell = document.createElement('td');
                var num2Cell = document.createElement('td');
                var answerCell = document.createElement('td');
                var timeCell = document.createElement('td');

                numberCell.textContent = questionNumber;
                num1Cell.textContent = question.num1;
                num2Cell.textContent = question.num2;
                answerCell.textContent = question.answer;
                timeCell.textContent = questionTime;

                row.appendChild(numberCell);
                row.appendChild(num1Cell);
                row.appendChild(num2Cell);
                row.appendChild(answerCell);
                row.appendChild(timeCell);
                tableBody.appendChild(row);
            }

            // Append the table header and body to the table element
            table.appendChild(tableHeader);
            table.appendChild(tableBody);

            // Append the table to the result element
            resultElement.appendChild(table);



            document.getElementById('settings').style.display = 'block';
            document.getElementById('resultsWindow').style.display = 'block';
            document.getElementById('result-container').style.display = 'block';
            document.getElementById('quiz-window').style.display = 'none';
            document.getElementById('input').value = '';
            document.getElementById('start-btn').disabled = false;

            logData = log;
            var times = logData.map(item => item.time);
            var questionIndices = logData.map((item, index) => index + 1);

            var ctx = document.getElementById('resultsGraph');
            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: questionIndices,
                    datasets: [{
                        label: 'Time (ms)',
                        data: times,
                        backgroundColor: 'rgba(75, 192, 192, 0.8)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function clearCanvas() {
            var canvas = document.getElementById('resultsGraph');
            var context = canvas.getContext('2d');
            context.clearRect(0, 0, canvas.width, canvas.height);

            if (myChart) {
                myChart.destroy();
            }
        }

        function resetQuiz() {
            questions = [];
            clearCanvas();
            currentIndex = 0;
            startTime = null;
            questionStartTime = null;
            log = [];
            totalTime = 0;
            clearInterval(timerInterval);
            timerInterval = null;
            document.getElementById('total-time').textContent = '0s';
            document.getElementById('question-number').textContent = '0/0';
            document.getElementById('question-time').textContent = '0s';
            document.getElementById('result').innerHTML = '';
            document.getElementById('main_results').innerHTML = '';
        }

        function updateTimer() {
            var currentTime = new Date() - startTime;
            var totalTimerElement = document.getElementById('total-time');
            totalTimerElement.textContent = (currentTime / 1000).toFixed(1) + 's';

            var questionTime = new Date() - questionStartTime;
            var questionTimerElement = document.getElementById('question-time');
            questionTimerElement.textContent = (questionTime / 1000).toFixed(1) + 's';
        }

        function updateQuestionNumber() {
            var questionNumberElement = document.getElementById('question-number');
            questionNumberElement.textContent = (currentIndex + 1) + '/' + questionCount;
        }

        function startQuiz() {
            resetQuiz();

            questionCount = parseInt(document.getElementById('question-count').value);
            limitNumber = parseInt(document.getElementById('limit-number').value);
            generateQuestions();
            displayQuestion(0);
            startTime = new Date();
            questionStartTime = new Date();
            updateQuestionNumber();
            timerInterval = setInterval(updateTimer, 1);
            document.getElementById('settings').style.display = 'none';
            document.getElementById('resultsWindow').style.display = 'none';
            document.getElementById('result-container').style.display = 'none';
            document.getElementById('quiz-window').style.display = 'block';
            document.getElementById('input').focus();
            document.getElementById('start-btn').disabled = true;
        }

        var startBtn = document.getElementById('start-btn');
        startBtn.addEventListener('click', startQuiz);

        var inputElement = document.getElementById('input');
        inputElement.addEventListener('input', checkAnswer);
        inputElement.addEventListener('keyup', function(event) {
            if (event.keyCode === 13) { // Enter key
                event.preventDefault();
                inputElement.value = '';
            }
        });
    </script>
</body>

</html>